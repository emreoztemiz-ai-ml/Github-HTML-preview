<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub HTML Önizleyici</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            color: #333;
            transition: background-color 0.3s ease;
        }
        body.dark-theme {
            background-color: #121212;
            color: #eee;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: background-color 0.3s ease;
        }
        .container.dark-theme {
            background-color: #1f1f1f;
            box-shadow: 0 2px 4px rgba(255,255,255,0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #1e3a8a;
            transition: color 0.3s ease;
        }
        h1.dark-theme {
            color: #60a5fa;
        }
        .input-area {
            display: flex;
            margin-bottom: 20px;
        }
        .input-area input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        .input-area input.dark-theme {
            background-color: #2a2a2a;
            border-color: #4a5568;
            color: #eee;
        }
        .input-area input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.15);
        }
        .input-area button {
            padding: 10px 16px;
            background-color: #3b82f6;
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .input-area button:hover {
            background-color: #2563eb;
        }
        .input-area button:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .button-group {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .button-group button {
            margin: 0 8px;
            padding: 10px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            color: #333;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        .button-group button:hover {
            background-color: #f0f0f0;
            border-color: #3b82f6;
            color: #3b82f6;
        }
        .button-group button.dark-theme {
            background-color: #1f1f1f;
            color: #eee;
            border-color: #4a5568;
        }
        .button-group button.dark-theme:hover {
            background-color: #2a2a2a;
            color: #60a5fa;
            border-color: #60a5fa;
        }
        .button-group button.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .button-group button.active.dark-theme {
            background-color: #60a5fa;
            color: #121212;
            border-color: #60a5fa;
        }
        #resultContainer {
            display: none;
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            transition: border-color 0.3s ease;
        }
        #resultContainer.dark-theme {
            border-color: #4a5568;
        }
        .tab-buttons {
            display: flex;
            background-color: #f0f0f0;
            border-bottom: 1px solid #ddd;
            border-radius: 8px 8px 0 0;
            overflow-x: auto;
            transition: background-color 0.3s ease, border-bottom-color 0.3s ease;
        }
        .tab-buttons.dark-theme {
            background-color: #1f1f1f;
            border-bottom-color: #4a5568;
        }
        .tab-button {
            padding: 12px 24px;
            text-align: center;
            cursor: pointer;
            white-space: nowrap;
            border: none;
            background-color: transparent;
            color: #333;
            transition: background-color 0.3s ease, color 0.3s ease;
            font-weight: 500;
        }
        .tab-button:hover {
            background-color: #ddd;
        }
        .tab-button.dark-theme {
            color: #eee;
        }
        .tab-button.dark-theme:hover {
            background-color: #2a2a2a;
        }
        .tab-button.active {
            background-color: #fff;
            color: #3b82f6;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1) inset;
        }
        .tab-button.active.dark-theme {
            background-color: #121212;
            color: #60a5fa;
            box-shadow: 0 -2px 4px rgba(255,255,255,0.1) inset;
        }
        .tab-content {
            padding: 20px;
            display: none;
            border-radius: 0 0 8px 8px;
            background-color: #fff;
            transition: background-color 0.3s ease;
        }
        .tab-content.dark-theme {
            background-color: #121212;
        }
        .tab-content.active {
            display: block;
        }
        #previewTab iframe {
            width: 100%;
            height: 500px;
            border: none;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: border-color 0.3s ease;
        }
        #previewTab iframe.dark-theme {
            border-color: #4a5568;
        }
        #responsiveTab {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #responsiveTab iframe {
            width: 100%;
            height: 500px;
            border: none;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 20px;
            transition: border-color 0.3s ease;
        }
        #responsiveTab iframe.dark-theme {
            border-color: #4a5568;
        }
        .device-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .device-buttons button {
            margin: 0 8px;
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            color: #333;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        .device-buttons button:hover {
            background-color: #f0f0f0;
            border-color: #3b82f6;
            color: #3b82f6;
        }
        .device-buttons button.dark-theme {
            background-color: #1f1f1f;
            color: #eee;
            border-color: #4a5568;
        }
        .device-buttons button.dark-theme:hover {
            background-color: #2a2a2a;
            color: #60a5fa;
            border-color: #60a5fa;
        }
        #sourceTab pre {
            overflow-x: auto;
            background-color: #f7f7f7;
            padding: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            line-height: 1.5;
            white-space: pre-wrap;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        #sourceTab pre.dark-theme {
            background-color: #0d1117;
            color: #e6edf3;
            border-color: #4a5568;
        }
        #errorMessage {
            color: red;
            margin-top: 20px;
            display: none;
            padding: 10px;
            background-color: #ffe5e5;
            border: 1px solid #ffcccc;
            border-radius: 4px;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }
        #errorMessage.dark-theme {
            background-color: #311717;
            border-color: #4a1e1e;
            color: #fecaca;
        }
        #loading {
            display: none;
            justify-content: center;
            align-items: center;
            height: 100px;
        }
        .spinner {
            border: 5px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 5px solid #3b82f6;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            transition: border-top-color 0.3s ease;
        }
        .spinner.dark-theme {
            border-top-color: #60a5fa;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .result-actions {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
        }
        .result-actions button {
            margin-left: 8px;
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            color: #333;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
            font-weight: 500;
        }
        .result-actions button:hover {
            background-color: #f0f0f0;
            border-color: #3b82f6;
            color: #3b82f6;
        }
        .result-actions button.dark-theme {
            background-color: #1f1f1f;
            color: #eee;
            border-color: #4a5568;
        }
        .result-actions button.dark-theme:hover {
            background-color: #2a2a2a;
            color: #60a5fa;
            border-color: #60a5fa;
        }
        .example-urls {
            margin-top: 20px;
            text-align: center;
            font-size: 0.9em;
            color: #6b7280;
        }
        .example-urls a {
            color: #3b82f6;
            text-decoration: none;
            margin: 0 4px;
            transition: color 0.3s ease;
        }
        .example-urls a:hover {
            color: #2563eb;
        }
        .example-urls a.dark-theme {
            color: #60a5fa;
        }
        .example-urls a.dark-theme:hover {
            color: #3b82f6;
        }
        #themeToggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            border-radius: 4px;
            background-color: white;
            color: #333;
            cursor: pointer;
            border: 1px solid #ddd;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
            z-index: 1000;
        }
        #themeToggle:hover {
            background-color: #f0f0f0;
        }
        #themeToggle.dark-theme {
            background-color: #1f1f1f;
            color: #eee;
            border-color: #4a5568;
        }
        #themeToggle.dark-theme:hover {
            background-color: #2a2a2a;
        }
    </style>
</head>
<body class="">
    <button id="themeToggle">Tema</button>
    <div class="container ">
        <h1>GitHub HTML Önizleyici</h1>
        <div class="input-area">
            <input type="text" id="githubUrl" placeholder="GitHub HTML Dosya URL'sini girin (örn. https://github.com/kullanici/repo/blob/main/index.html)">
            <button id="viewButton">Görüntüle</button>
        </div>
        <div class="button-group">
            <button id="clearButton">Temizle</button>
        </div>
        <div class="example-urls">
            Örnek URL'ler:
            <a href="#" class="example-url">emreoztemiz-ai-ml/Running-contexts-without-needing-a-Mobile-App/blob/main/index.html</a>
            |
            <a href="#" class="example-url">emreoztemiz-ai-ml/Github-HTML-Preview/blob/main/index.html</a>
        </div>
        <div id="resultContainer">
             <div class="result-actions">                <button id="copyUrlButton">URL Kopyala</button>                <button id="copyRawButton">Raw URL Kopyala</button>                <button id="refreshButton">                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">                        <path fill-rule="evenodd" d="M8 3a5 5 0 100 10A5 5 0 008 3zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"></path>                        <path d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM8 0a8 8 0 100 16A8 8 0 008 0zM5 8a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm-3 1a1 1 0 100-2 1 1 0 000 2z"></path>                    </svg>                </button>                <button id="fullScreenButton">Tam Ekran</button>            </div>
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="preview">Önizleme</button>
                <button class="tab-button" data-tab="responsive">Responsive</button>
                <button class="tab-button" data-tab="source">Kaynak Kodu</button>
            </div>
            <div id="previewTab" class="tab-content active">
                <iframe id="previewFrame" class=""></iframe>
            </div>
            <div id="responsiveTab" class="tab-content">
                <div class="device-buttons">
                    <button id="mobile">Mobil</button>
                    <button id="tablet">Tablet</button>
                    <button id="desktop">Masaüstü</button>
                    <button id="wide">Geniş Ekran</button>
                </div>
                <iframe id="responsiveFrame" class=""></iframe>
            </div>
            <div id="sourceTab" class="tab-content">
                <pre id="sourceCode" class=""></pre>
            </div>
            <div id="loading" class="">
                <div class="spinner "></div>
            </div>
            <div id="errorMessage" class=""></div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const githubUrlInput = document.getElementById('githubUrl');
            const viewButton = document.getElementById('viewButton');
            const clearButton = document.getElementById('clearButton');
            const resultContainer = document.getElementById('resultContainer');
            const previewFrame = document.getElementById('previewFrame');
            const responsiveFrame = document.getElementById('responsiveFrame');
            const sourceCode = document.getElementById('sourceCode');
            const resultTitle = document.getElementById('resultTitle');
            const originalLink = document.getElementById('originalLink');
            const copyUrlButton = document.getElementById('copyUrlButton');
            const copyRawButton = document.getElementById('copyRawButton');
            const refreshButton = document.getElementById('refreshButton');
            const errorMessage = document.getElementById('errorMessage');
            const loading = document.getElementById('loading');
            const themeToggle = document.getElementById('themeToggle');
            const exampleUrls = document.querySelectorAll('.example-url');
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            const deviceButtons = document.querySelectorAll('.device-button');
            const fullScreenButton = document.getElementById('fullScreenButton');

            // Theme switching
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-theme');
                localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
                // Update CSS class for elements that require dynamic theme change
                const elements = [
                    container,
                    githubUrlInput,
                    ...tabButtons,
                    ...tabContents,
                    previewFrame,
                    responsiveFrame,
                    sourceCode,
                    errorMessage,
                ];
                elements.forEach(el => {
                    if (el) {
                        el.classList.toggle('dark-theme');
                    }
                });
            });

            // Load saved theme
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-theme');
                 const elements = [
                    container,
                    githubUrlInput,
                    ...tabButtons,
                    ...tabContents,
                    previewFrame,
                    responsiveFrame,
                    sourceCode,
                    errorMessage,
                ];
                elements.forEach(el => {
                    if (el) {
                         el.classList.toggle('dark-theme');
                    }
                });
            }

            // Example URLs
            exampleUrls.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    githubUrlInput.value = `https://github.com/${this.textContent}`;
                });
            });

            // Tab switching
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');

                    tabButtons.forEach(btn => {
                        btn.classList.remove('active');
                    });

                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });

                    this.classList.add('active');
                    document.getElementById(`${tabName}Tab`).classList.add('active');

                    if (tabName === 'responsive' && responsiveFrame.src !== previewFrame.src) {
                        responsiveFrame.src = previewFrame.src;
                    }
                });
            });

            // Responsive device selection
            deviceButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.id;
                    let width;

                    switch (id) {
                        case 'mobile':
                            width = '375px';
                            break;
                        case 'tablet':
                            width = '768px';
                            break;
                        case 'desktop':
                            width = '1024px';
                            break;
                        case 'wide':
                            width = '1440px';
                            break;
                        default:
                            width = '1024px';
                    }

                    responsiveFrame.style.width = width;
                });
            });

            // Convert GitHub URL to raw URL
            function convertToRawUrl(url) {
                try {
                    // Extract relevant parts of the URL
                    const githubRegex = /https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/blob\/([^\/]+)\/(.+)/;
                    const match = url.match(githubRegex);

                    if (!match) {
                        throw new Error("Geçersiz GitHub URL formatı. Lütfen bir GitHub blob URL'si girin.");
                    }

                    const [, owner, repo, branch, path] = match;
                    return `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${path}`;
                } catch (error) {
                    throw error;
                }
            }

            // Display error message
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 5000);
            }

            // Show loading state
            function showLoading() {
                resultContainer.style.display = 'block';
                loading.style.display = 'flex';
                document.getElementById('previewTab').style.display = 'none';
                document.getElementById('sourceTab').style.display = 'none';
                document.getElementById('responsiveTab').style.display = 'none';
                document.querySelectorAll('.tab-button').forEach(btn => btn.style.display = 'none');
            }

            // Hide loading state
            function hideLoading() {
                loading.style.display = 'none';
                document.getElementById('previewTab').style.display = 'block';
                document.querySelectorAll('.tab-button').forEach(btn => btn.style.display = 'block');
            }

            // Fetch and display HTML content
            async function fetchAndDisplayHTML(url) {
                try {
                    showLoading();
                    const rawUrl = convertToRawUrl(url);
                    const response = await fetch(rawUrl);

                    if (!response.ok) {
                        throw new Error(`Dosya alınamadı: ${response.status} ${response.statusText}`);
                    }

                    const htmlContent = await response.text();

                    // Base URL'i oluştur
                    const baseUrlParts = rawUrl.split('/');
                    baseUrlParts.pop(); // Dosya adını kaldır
                    const baseUrl = baseUrlParts.join('/') + '/';

                    // <base> etiketini HTML'e ekle
                    const modifiedHtmlContent = htmlContent.replace('<head>', `<head><base href="${baseUrl}">`);

                    // Update title and links
                    const pathParts = url.split('/');
                    const fileName = pathParts[pathParts.length - 1];
                    resultTitle.textContent = fileName;
                    originalLink.href = url;

                    // Set the HTML content in the iframe
                    const iframe = previewFrame;
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    iframeDoc.open();
                    iframeDoc.write(modifiedHtmlContent); // Burada modifiedHtmlContent kullanılıyor
                    iframeDoc.close();

                    // Set the source code
                    sourceCode.textContent = htmlContent;

                    // Store the raw URL
                    previewFrame.setAttribute('data-raw-url', rawUrl);

                    // Reset the active tab
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active');
                    });
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    document.querySelector('[data-tab="preview"]').classList.add('active');
                    document.getElementById('previewTab').classList.add('active');

                    hideLoading();
                } catch (error) {
                    hideLoading();
                    showError(error.message);
                }
            }

            // View button click handler
            viewButton.addEventListener('click', function() {
                const url = githubUrlInput.value.trim();

                if (!url) {
                    showError("Lütfen bir GitHub HTML dosya URL'si girin.");
                    return;
                }

                try {
                    // Validate URL format
                    if (!url.includes('github.com') || !url.includes('/blob/')) {
                        throw new Error("Geçersiz GitHub URL formatı. Lütfen bir GitHub blob URL'si girin.");
                    }

                    fetchAndDisplayHTML(url);
                } catch (error) {
                    showError(error.message);
                }
            });

            // Clear button click handler
            clearButton.addEventListener('click', function() {
                githubUrlInput.value = '';
                resultContainer.style.display = 'none';
            });

            // Copy URL button click handler
            copyUrlButton.addEventListener('click', function() {
                navigator.clipboard.writeText(githubUrlInput.value).then(() => {
                    this.textContent = "Kopyalandı!";
                    setTimeout(() => {
                        this.textContent = "URL Kopyala";
                    }, 2000);
                });
            });

          // Full Ekran görüntüleme
fullScreenButton.addEventListener('click', function() {
    const iframe = document.getElementById('previewFrame');
    if (iframe) {
        // Tam ekran API'sini kullanmayı dene
        if (iframe.requestFullscreen) {
            iframe.requestFullscreen().catch(err => {
                console.error(`Tam ekran hatası: ${err.message} (Fallback yöntemi kullanılacak)`, err);
                // Fallback yöntemi olarak pop-up kullan
                openIframeInNewWindow(iframe);
            });
        } else if (iframe.mozRequestFullScreen) { // Firefox
            iframe.mozRequestFullScreen().catch(err => {
                console.error(`Tam ekran hatası: ${err.message} (Fallback yöntemi kullanılacak)`, err);
                openIframeInNewWindow(iframe);
            });
        } else if (iframe.webkitRequestFullscreen) { // Safari ve Chrome
            iframe.webkitRequestFullscreen().catch(err => {
                console.error(`Tam ekran hatası: ${err.message} (Fallback yöntemi kullanılacak)`, err);
                openIframeInNewWindow(iframe);
            });
        } else if (iframe.msRequestFullscreen) { // Internet Explorer
            iframe.msRequestFullscreen().catch(err => {
                console.error(`Tam ekran hatası: ${err.message} (Fallback yöntemi kullanılacak)`, err);
                openIframeInNewWindow(iframe);
            });
        }
         else {
            // Tarayıcı tam ekranı desteklemiyorsa, pop-up kullan
            openIframeInNewWindow(iframe);
        }
    } else {
        showError('Önizleme alanı bulunamadı.');
    }
});

function openIframeInNewWindow(iframe) {
    const iframeDoc = iframe.contentWindow.document.documentElement.outerHTML;
    const newWindow = window.open('', '_blank', 'noopener, noreferrer, width=screen,height=screen');
    if (newWindow) {
        newWindow.document.open();
        newWindow.document.write(iframeDoc);
        newWindow.document.close();
    } else {
        showError('Pop-up engellendi. Lütfen tarayıcı ayarlarınızı kontrol edin.');
    }
}


            // Copy Raw URL button click handler
            copyRawButton.addEventListener('click', function() {
                try {
                    const rawUrl = previewFrame.getAttribute('data-raw-url');
                    if (!rawUrl) {
                        throw new Error("Önce bir dosya görüntüleyin.");
                    }

                    navigator.clipboard.writeText(rawUrl).then(() => {
                        this.textContent = "Kopyalandı!";
                        setTimeout(() => {
                            this.textContent = "Raw URL Kopyala";
                        }, 2000);
                    });
                } catch (error) {
                    showError(error.message);
                }
            });

            // Refresh button click handler
            refreshButton.addEventListener('click', function() {
                const url = githubUrlInput.value.trim();
                if (url) {
                    fetchAndDisplayHTML(url);
                }
            });

            // Handle Enter key in input field
            githubUrlInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    viewButton.click();
                }
            });

            // Initialize with example URL if empty
            if (!githubUrlInput.value.trim()) {
                githubUrlInput.value = 'https://github.com/emreoztemiz-ai-ml/Running-contexts-without-needing-a-Mobile-App/blob/main/index.html';
            }
        });
    </script>
</body>
</html>
